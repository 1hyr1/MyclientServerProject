import socket
import threading
from collections import defaultdict

class TupleSpace:
    def __init__(self):
        self.tuples = {}
        self.lock = threading.Lock()

            def read(self, key):
        with self.lock:
            if key in self.tuples:
                return f"OK ({key}, {self.tuples[key]}) read"
            else:
                return f"ERR {key} does not exist"

    def get(self, key):
        with self.lock:
            if key in self.tuples:
                value = self.tuples.pop(key)
                return f"OK ({key}, {value}) removed"
            else:
                return f"ERR {key} does not exist"

    def put(self, key, value):
        with self.lock:
            if key not in self.tuples:
                self.tuples[key] = value
                return f"OK ({key}, {value}) added"
            else:
                return f"ERR {key} already exists"

        def handle_client(client_socket, tuple_space):
    while True:
        try:
            request = client_socket.recv(1024).decode('utf-8')
            if not request:
                break
            print(f"Received: {request}")